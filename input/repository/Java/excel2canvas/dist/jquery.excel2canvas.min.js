(function(d){var h=1,q=2,o=3,l=4,a=5,n=6,c=7,m=8,p=9,e=10,r=11,j=12,g=13,b;function i(){return !!d.fn.tooltip}function f(w,x){var s=x.back,t=x.fore,v=x.pattern;if(x.styleRef){var u=w.styles[x.styleRef].split("|");s=u[0];t=u[1];v=u[2]}if(t){b.fillStyle=t;b.fillRect(x.p[0],x.p[1],x.p[2],x.p[3])}}function k(C){var z=C.kind?C.kind:1,D=1,I=C.p[0],u=C.p[1],F=C.p[2],s=C.p[3],M=u==s;if(z==q||z==m||z==e||z==j){D=2}else{if(z==a){D=3}}b.lineWidth=D;if(D==1||D==3){if(M){u=u==0?0.5:u-0.5;s=s==0?0.5:s-0.5}else{I=I==0?0.5:I-0.5;F=F==0?0.5:F-0.5}}else{if(M&&u==0){u=1;s=1}else{if(!M&&I==0){I=1;F=1}}}if(C.color){b.strokeStyle=C.color}else{b.strokeStyle="#000000"}if(z==n){b.beginPath();if(M){b.moveTo(I,u-1);b.lineTo(F,s-1);b.moveTo(I,u+1);b.lineTo(F,s+1)}else{b.moveTo(I-1,u);b.lineTo(F-1,s);b.moveTo(I+1,u);b.lineTo(F+1,s)}b.stroke();b.closePath()}else{if(z==o||z==l||z==c||z==m){var J,E;switch(z){case o:J=4;E=2;break;case l:J=2;E=2;break;case c:J=1;E=1;break;case m:J=8;E=3;break}var H=true;b.beginPath();b.moveTo(I,u);if(M){var A=u,v=I,K=F;while(v<K){var N=H?J:E;v+=N;if(v>K){v=K}if(H){b.lineTo(v,A)}else{b.moveTo(v,A)}H=!H}}else{var B=I,t=u,G=s;while(t<G){var L=H?J:E;t+=L;if(t>G){t=G}if(H){b.lineTo(B,t)}else{b.moveTo(B,t)}H=!H}}b.stroke();b.closePath()}else{b.beginPath();b.moveTo(I,u);b.lineTo(F,s);b.stroke();b.closePath()}}}d.fn.excelToCanvas=function(L,u){var B,v;if(this[0].tagName=="canvas"){v=this;B=v.parent()}else{B=this;v=B.find("canvas");if(v.length==0){v=d("<canvas style='position:absolute;left:0;top:0;z-index:0'></canavas>").appendTo(B)}}if(typeof FlashCanvas!=="undefined"){FlashCanvas.initElement(v[0])}v.attr("width",L.width).attr("height",L.height);B.css({width:L.width,height:L.height});b=v[0].getContext("2d");b.fillStyle="white";b.fillRect(0,0,L.width,L.height);if(L.font){b.font=L.font}if(L.fills){for(var J=0;J<L.fills.length;J++){var G=L.fills[J];f(L,G)}}if(L.lines){for(var J=0;J<L.lines.length;J++){var z=L.lines[J];k(z)}}if(L.strs){for(var J=0;J<L.strs.length;J++){var F=L.strs[J],K=F.style?F.style:L.styles[F.styleRef],I=d("<span style='"+K+"'></span>");if(F.link){var x=d("<a target='_blank'></a>");x.append(F.text);x.attr("href",F.link);I.append(x)}else{I.append(F.text)}var H=F.align;if(H){I.addClass("cell-a"+H[0]);I.addClass("cell-v"+H[1]);if(H[1]=="c"||H[1]=="j"){var E=F.text.split("<br>").length;if(E>1){I.css("margin-top","-"+(E/2)+"em")}}}if(F.rawdata){I.attr("data-raw",F.rawdata)}var A=d("<div id='"+F.id+"' class='cell'></div>").append(I);A.css({left:F.p[0],top:F.p[1],width:F.p[2],height:F.p[3]});if(F.clazz){A.addClass(F.clazz)}if(F.dataAttrs){d.each(F.dataAttrs,function(O,P){A.attr("data-"+O,P)})}if(F.comment&&i()){b.strokeStyle="red";b.fillStyle="red";b.beginPath();b.moveTo(F.p[0]+F.commentWidth-4,F.p[1]);b.lineTo(F.p[0]+F.commentWidth,F.p[1]);b.lineTo(F.p[0]+F.commentWidth,F.p[1]+4);b.lineTo(F.p[0]+F.commentWidth-4,F.p[1]);b.stroke();b.fill();b.closePath();A.tooltip({title:F.comment,html:true})}B.append(A)}}if(L.pictures){for(var J=0;J<L.pictures.length;J++){var D=L.pictures[J],N=d("<img class='excel-img'/>");N.attr("src",D.uri);N.css({left:D.p[0],top:D.p[1],width:D.p[2],height:D.p[3]});B.append(N)}}if(L.charts&&d.fn.excelToChart){for(var J=0;J<L.charts.length;J++){var C=L.charts[J],w={},s=d("<div class='excel-chart'></div>");s.css({left:C.p[0],top:C.p[1],width:C.p[2],height:C.p[3]});B.append(s);if(L.font){w.HtmlText=true}s.excelToChart(C.chart,w);s.css("position","absolute")}}if(u){for(var M in u){var A=d("#"+M);if(A.length>0){var y=u[M];if(typeof(y)==="string"){A.find("span").text(y)}else{if(y.element){var t=d(document.createElement(y.element));for(attr in y){if(attr!="element"){t.attr(attr,y[attr])}}A.css("overflow","visible").empty().append(t)}}}}}return this}})(jQuery);